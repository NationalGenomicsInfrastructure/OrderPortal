{# User page. #}

{% extends "base.html" %}

{% block head_title %}User {{ user['email'] }}{% end %}
{% block body_title %}
{% module Icon('user', label=True) %}
{{ user['email'] }}
{% end %}

{% block content %}
<div class="row">
  <div class="col-sm-9 col-sm-offset-1">
    <table class="table-condensed table-fields">
      <tr>
	<th>Email address</th>
	<td>{{ user['email'] }}</td>
      </tr>
      <tr>
	<th>Role</th>
	<td>{% module Icon(user['role'], label=True) %}</td>
      </tr>
      <tr>
	<th>Status</th>
	<td>{% module Icon(user['status'], label=True) %}</td>
      </tr>
      <tr>
	<th>Modified</th>
	<td>
	  <a href="{{ reverse_url('user_logs', user['email']) }}" class="localtime">
	    {{ user['modified'] }}
	  </a>
	</td>
      </tr>
      <tr>
	<th>Created</th>
	<td class="localtime">{{ user['created'] }}</td>
      </tr>
      <tr>
	<th>First name</th>
	<td>{{ user.get('first_name') or '-' }}</td>
      </tr>
      <tr>
	<th>Last name</th>
	<td>{{ user.get('last_name') or '-' }}</td>
      </tr>
      <tr>
	<th>University</th>
	<td>{{ user.get('university') or '-' }}</td>
      </tr>
      <tr>
	<th>Department</th>
	<td>{{ user.get('department') or '-' }}</td>
      </tr>
      <tr>
	<th>Address</th>
	<td class="pre">{{ user.get('address') or '-' }}</td>
      </tr>
      <tr>
	<th>Phone</th>
	<td>{{ user.get('phone') or '-' }}</td>
      </tr>
    </table>
  </div>

  <div class="col-sm-2">
    <p>
      <form action="{{ reverse_url('user_edit', user['email']) }}"
	    role="form" method='GET'>
	<button class="btn btn-default btn-block">
	  {% module Icon('edit', label=True) %}
	</button>
      </form>
    </p>

    {% if is_admin and current_user['email'] != user['email'] %}
    {% if user['status'] in (constants.PENDING, constants.DISABLED) %}
    <p>
      <form action="{{ reverse_url('user_enable', user['email']) }}"
	    role="form" method='POST'>
	{% module xsrf_form_html() %}
	<button class="btn btn-default btn-block">
	  {% module Icon('enable', label=True) %}
	</button>
      </form>
    </p>
    {% else %}
    <p>
      <form action="{{ reverse_url('user_disable', user['email']) }}"
	    role="form" method='POST'>
	{% module xsrf_form_html() %}
	<button class="btn btn-default btn-block">
	  {% module Icon('disable', label=True) %}
	</button>
      </form>
    </p>
    {% end %}

    {% if user['status'] == constants.PENDING %}
    <p>
      <form action="{{ reverse_url('user', user['email']) }}"
	    role="form" method='POST'>
	{% module xsrf_form_html() %}
	<input type="hidden" name="_http_method" value="delete">
	<button class="btn btn-default btn-block">
	  {% module Icon('delete', label=True) %}
	</button>
      </form>
    </p>
    {% end %}
    {% end %}
  </div>

</div>
{% end %} {# block content #}
