# OrderPortal order status definitions and transitions

statuses:
  preparation:
    identifier: preparation
    initial: true
    description:  The order has been created and is being edited by the user.
    edit: [user, staff]

  submitted:
    identifier: submitted
    label: Submit
    description: The order has been submitted by the user for consideration by the facility.

  review:
    identifier: review
    description: The order is under review by the facility.
    edit: [staff]

  accepted:
    identifier: accepted
    description: The order has been checked and accepted by the facility.

  rejected:
    identifier: rejected
    description: The order has been rejected by the facility.

  pending:
    identifier: pending
    description: The facility is awaiting further input from the user. (= Zendesk 'On Hold')

  queued:
    identifier: queued
    description: The facility has placed the order in its work queue.

  working:
    identifier: working
    description: The facility is working on the order, in the lab or in data analysis.

  waiting:
    identifier: waiting
    description: Work has paused, for some reason.

  cancelled:
    identifier: cancelled
    description: The work on the order has been permanently stopped by the user.

  aborted:
    identifier: aborted
    description: The work on the order has been permanently stopped by the facility.

  finished:
    identifier: finished
    description: The facility has finished working on the order.

  delivered:
    identifier: delivered
    description: The results of the order have been delivered to the user.

  invoiced:
    identifier: invoiced
    description: The user has been invoiced for the order.

  closed:
    identifier: closed
    description: All work and other actions for the order have been performed.

  archived:
    identifier: archived
    description: The order and its data have been archived and cannot be changed.

transitions:
  - source: null
    targets: [preparation]
    permission: user

  - source: preparation
    targets: []
    permission: user

  - source: preparation
    targets: [submitted]
    permission: user
    require: valid

  - source: submitted
    targets: [review, accepted, rejected, pending]
    permission: staff

  - source: review
    targets: [accepted, rejected, pending]
    permission: staff

  - source: accepted
    targets: [pending, queued, working, waiting]
    permission: staff

  - source: rejected
    targets: [preparation]
    permission: user

  - source: pending
    targets: [queued, working, waiting]
    permission: staff

  - source: queued
    targets: [working, waiting]
    permission: staff

  - source: working
    targets: [waiting, aborted, finished]
    permission: staff

  - source: waiting
    targets: [working, aborted, finished]
    permission: staff

  - source: finished
    targets: [delivered]
    permission: staff
